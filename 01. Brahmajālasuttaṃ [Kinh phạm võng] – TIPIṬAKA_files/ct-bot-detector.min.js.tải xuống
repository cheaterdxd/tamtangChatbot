if(!window.BOT_DETECTOR_LOADED){window.BOT_DETECTOR_LOADED=!0;class a{static moderateUrl="https://fd.cleantalk.org/api3.0/frontend_data";static endpoints={moderate:["frontend_data"]};static send(o,s){return new Promise((t,r)=>{let a;if(-1===this.endpoints.moderate.indexOf(o))r(new Error("Method name unknown. "+o));else{a=new URL(this.moderateUrl);let e=new XMLHttpRequest;e.open("POST",a),e.timeout=15e3,e.setRequestHeader("Content-Type","application/json"),s.method_name=o,e.send(JSON.stringify(s)),e.onload=()=>{t(e)},e.onerror=()=>{r(new Error("Connection error. "+a.toString()))}}})}}class b{constructor(){this.storageKey="bot_detector_cron_storage",this.cronEventName="cronHubEvent",this.tickStep=500,this.tickFirst=500,this.ticksCount=0,this.taskTemplate={firstRunOnStep:1,runEveryNStep:2,clientInfoGetter:"",event:"",log:{getter_last_call:0,getter_calls_count:0}},this.initializeStorage(),this.scheduleTasks()}runService(){this.ticksCount=0,setTimeout(()=>{setInterval(()=>this.tick(),this.tickStep)},this.tickFirst)}tick(){this.ticksCount++;var e=this.collectClientInfo();this.isClientInfoReady(e)&&botDetectorSendClientInfoToCloud(this.mergeClientInfo(e),this.cronEventName)}collectClientInfo(){var t,e,r=this.getStorage(),a={};for([t,e]of Object.entries(r))try{this.shouldRunTask(e)&&this.isValidGetter(e.clientInfoGetter)&&(a[t]=this[e.clientInfoGetter](),this.isClientInfoReady(a))&&(r[t].log.getter_last_call=Math.floor(Date.now()/1e3),r[t].log.getter_calls_count++,this.setStorage(r))}catch(e){console.error(`Error executing getter for event "${t}":`,e)}return a}isValidGetter(e){return"function"==typeof this[e]}shouldRunTask(e){return this.ticksCount>=e.firstRunOnStep&&this.ticksCount%e.runEveryNStep==0}isClientInfoReady(e){return e&&"object"==typeof e&&0<Object.keys(e).length&&Object.values(e).some(e=>e&&e.agent&&e.timestamp&&2<Object.keys(e).length)}mergeClientInfo(e){var t,r={};for(t of Object.values(e))for(var[a,o]of Object.entries(t))null===o?r[a]=null:r[a]=o;return r}initializeStorage(){this.setStorage({})}getStorage(){return d.get(this.storageKey)||{}}setStorage(e){e&&"object"==typeof e?d.set(this.storageKey,e):console.error("Invalid storage data format")}addTask(e,t,r,a){if("string"!=typeof e||""===e.trim())throw new Error("Invalid event name: must be a non-empty string");if("string"!=typeof t||""===t.trim())throw new Error("Invalid clientInfoGetter: must be a non-empty string");if(void 0!==r&&(!Number.isInteger(r)||r<0))throw new Error("firstRunOnStep must be a non-negative integer");if(void 0!==a&&(!Number.isInteger(a)||a<=0))throw new Error("runEveryNStep must be a positive integer");e={...this.taskTemplate,event:e.trim(),clientInfoGetter:t.trim(),firstRunOnStep:Number.isInteger(r)?r:this.taskTemplate.firstRunOnStep,runEveryNStep:Number.isInteger(a)?a:this.taskTemplate.runEveryNStep};this.updateTaskInStorage(e)}updateTaskInStorage(e){var t=this.getStorage();t[e.event]=e,this.setStorage(t)}scheduleTasks(){this.addTask("send_typo_data","getTypoData",1,5),this.addTask("send_pointer_data","getPointerData",3,5),this.addTask("send_fingerprint_data","getFingerprint",1,5),this.addTask("send_scrolling_data","getScrollingParameters",3,5)}getTypoData(){var e=botDetectorCreateClientInfo();if(document.typoData?.data)for(var t in document.typoData.data){t=document.typoData.data[t];if(0<t.lastKeyTimestamp&&t.lastKeyTimestamp>Date.now()-l){e.typo=document.typoData.data;break}}return e}getPointerData(){var e=botDetectorCreateClientInfo(),t=d.get("bot_detector_pointer_data")||0;return 0!==t&&t.length&&h.last_data_length!==t.length&&(e.pointer_data=t,h.send_on_stop_collect&&(h.last_data_length=t.length,h.send_on_stop_collect=!1,h.send_on_cron=!1),h.send_on_cron)&&(h.last_data_length=t.length),e}getFingerprint(){var e=botDetectorCreateClientInfo(),t=d.get("bot_detector_f_hash");return!1===t?.sent&&(t.sent=Math.floor(Date.now()/1e3),d.set("bot_detector_f_hash",t),e.f_hash_data=t),e}getScrollingParameters(){var e=botDetectorCreateClientInfo(),t=d.isSet("bot_detector_scrolling_additional")?d.get("bot_detector_scrolling_additional","value"):0;return 0!==t&&void 0!==t.length&&m.last_data_length!==t.length&&(e.scrolling_additional=t,m.last_data_length=t.length),e}}class c{allParams={};modules={};paramStatus={};paramEntropy={};paramCategory={};recommended=[];progress=0;totalSteps=150;async hashString(e){var t=new TextEncoder;return this.hashBytes(t.encode(String(e)))}async hashBytes(t){if(!window.crypto||!window.crypto.subtle||"function"!=typeof window.crypto.subtle.digest)return console.warn("BotDetector say: Web Crypto API not available, using fallback hash function"),this.simpleHash(t);try{var e=await crypto.subtle.digest("SHA-256",t);return Array.from(new Uint8Array(e)).map(e=>e.toString(16).padStart(2,"0")).join("")}catch(e){return console.warn("BotDetector say: Web Crypto API failed, using fallback hash function:",e.message),this.simpleHash(t)}}simpleHash(t){if(0===(t="string"!=typeof t?t.toString():t).length)return"0".repeat(64);let r=0;for(let e=0;e<t.length;e++){var a=t.charCodeAt(e);r=(r<<5)-r+a,r&=r}let o=Math.abs(r).toString(16).padStart(8,"0");for(let e=0;e<7;e++){var s=(r*(e+1)^e+1)>>>0;o+=Math.abs(s).toString(16).padStart(8,"0")}return o.slice(0,64)}stableStringify(t){return null===t||"object"!=typeof t?JSON.stringify(t):Array.isArray(t)?"["+t.map(this.stableStringify).join(",")+"]":"{"+Object.keys(t).sort().map(e=>JSON.stringify(e)+":"+this.stableStringify(t[e])).join(",")+"}"}updateProgress(){this.progress++;var e=Math.min(this.progress/this.totalSteps*100,100),t=document.getElementById("progress");t&&(t.style.width=e.toFixed(1)+"%")}safeGet(e,t="unavailable"){try{var r=e();return null!=r?r:t}catch{return t}}addParam(e,t,r="success",a="medium",o="other"){let s,n,i;var c;"success"===(c=r)||"error"===c||"low"===(c=a)||"medium"===c||"high"===c?(s=r??"success",n=a??"medium",i=o??"other"):(i=r??"other",s=a??"success",n=o??"medium"),this.allParams[e]=t,this.paramStatus[e]=s,this.paramEntropy[e]=n,this.paramCategory[e]=i,this.modules[i]||(this.modules[i]={}),this.modules[i][e]=t,this.updateProgress()}async getStableCanvasHash(){var e=document.createElement("canvas"),t=(e.width=240,e.height=180,e.getContext("2d",{willReadFrequently:!0}));t.fillStyle="#ffffff",t.fillRect(0,0,e.width,e.height),t.fillStyle="#e53935",t.fillRect(10,10,70,50),t.beginPath(),t.fillStyle="#43a047",t.arc(120,90,38,0,2*Math.PI),t.fill(),t.strokeStyle="#1e88e5",t.lineWidth=2,t.beginPath();for(let e=0;e<8*Math.PI;e+=.11){var r=120+2.2*e*Math.cos(e),a=90+2.2*e*Math.sin(e);0===e?t.moveTo(r,a):t.lineTo(r,a)}t.stroke();e=t.getImageData(0,0,e.width,e.height).data;return this.hashBytes(e)}getWebGLParams(){var e=document.createElement("canvas");let i=e.getContext("webgl")||e.getContext("experimental-webgl"),r=e.getContext("webgl2"),a={};if(i){a.webgl_supported=!0,a.webgl2_supported=!!r;["MAX_TEXTURE_SIZE","MAX_CUBE_MAP_TEXTURE_SIZE","MAX_RENDERBUFFER_SIZE","MAX_VIEWPORT_DIMS","DEPTH_BITS","STENCIL_BITS","RED_BITS","GREEN_BITS","BLUE_BITS","ALPHA_BITS","MAX_VERTEX_ATTRIBS","MAX_VERTEX_UNIFORM_VECTORS","MAX_FRAGMENT_UNIFORM_VECTORS","MAX_VARYING_VECTORS","MAX_VERTEX_TEXTURE_IMAGE_UNITS","MAX_COMBINED_TEXTURE_IMAGE_UNITS","MAX_TEXTURE_IMAGE_UNITS","ALIASED_LINE_WIDTH_RANGE","ALIASED_POINT_SIZE_RANGE"].forEach(e=>{try{var t=i.getParameter(i[e]);a[e]=Array.isArray(t)?t.join(","):t}catch{a[e]="error"}}),r&&["MAX_3D_TEXTURE_SIZE","MAX_ARRAY_TEXTURE_LAYERS","MAX_DRAW_BUFFERS","MAX_COLOR_ATTACHMENTS","MAX_SAMPLES"].forEach(e=>{try{var t=r.getParameter(r[e]);a[e]=Array.isArray(t)?t.join(","):t}catch{a[e]="error"}});try{var t=i.getExtension("WEBGL_debug_renderer_info");a.UNMASKED_VENDOR=t?i.getParameter(t.UNMASKED_VENDOR_WEBGL):"masked",a.UNMASKED_RENDERER=t?i.getParameter(t.UNMASKED_RENDERER_WEBGL):"masked"}catch{a.UNMASKED_VENDOR="error",a.UNMASKED_RENDERER="error"}try{var o=(i.getSupportedExtensions()||[]).slice().sort(),s=(a.WEBGL_EXTENSIONS_SORTED=o.join(","),{s3tc:!!i.getExtension("WEBGL_compressed_texture_s3tc")||!!i.getExtension("MOZ_WEBGL_compressed_texture_s3tc")||!!i.getExtension("WEBKIT_WEBGL_compressed_texture_s3tc"),s3tc_srgb:!!i.getExtension("WEBGL_compressed_texture_s3tc_srgb"),etc1:!!i.getExtension("WEBGL_compressed_texture_etc1"),etc:!!i.getExtension("WEBGL_compressed_texture_etc"),pvrtc:!!i.getExtension("WEBGL_compressed_texture_pvrtc")||!!i.getExtension("WEBKIT_WEBGL_compressed_texture_pvrtc"),astc:!!i.getExtension("WEBGL_compressed_texture_astc"),rgtc:!!i.getExtension("EXT_texture_compression_rgtc"),bptc:!!i.getExtension("EXT_texture_compression_bptc")});a.WEBGL_SUPPORTED_COMPRESSIONS=JSON.stringify(s)}catch(e){a.WEBGL_EXT_LIST_ERROR=e.message}try{let n={},e=[i.LOW_FLOAT,i.MEDIUM_FLOAT,i.HIGH_FLOAT,i.LOW_INT,i.MEDIUM_INT,i.HIGH_INT];[["vertex",i.VERTEX_SHADER],["fragment",i.FRAGMENT_SHADER]].forEach(([o,s])=>{e.forEach((e,t)=>{try{var r,a=i.getShaderPrecisionFormat(s,e);a&&(r=["lowFloat","mediumFloat","highFloat","lowInt","mediumInt","highInt"][t],n[o+"_"+r]=`${a.precision},${a.rangeMin},`+a.rangeMax)}catch{}})}),a.FLOAT_INT_PRECISION=JSON.stringify(n)}catch{}}else a.webgl_supported=!1;return a}async getGLRenderSHA(){let d=this;try{return await Promise.race([(async()=>{var e=document.createElement("canvas"),t=(e.width=64,e.height=64,e.getContext("webgl",{preserveDrawingBuffer:!0})||e.getContext("experimental-webgl"));if(!t)return"unavailable";var r,a=[];for(r of["precision highp float; void main(){ gl_FragColor=vec4(fract(gl_FragCoord.xy*0.007),0.5,1.0); }","precision mediump float; float f(vec2 p){return sin(p.x)*cos(p.y);} void main(){vec2 u=gl_FragCoord.xy/64.0;gl_FragColor=vec4(f(u*31.0));}"]){var o,s,n=t.createShader(t.VERTEX_SHADER),i=(t.shaderSource(n,"attribute vec2 p;void main(){gl_Position=vec4(p,0.0,1.0);}"),t.compileShader(n),t.createShader(t.FRAGMENT_SHADER)),c=(t.shaderSource(i,r),t.compileShader(i),t.createProgram());t.attachShader(c,n),t.attachShader(c,i),t.linkProgram(c),t.getProgramParameter(c,t.LINK_STATUS)&&(t.useProgram(c),o=t.createBuffer(),t.bindBuffer(t.ARRAY_BUFFER,o),t.bufferData(t.ARRAY_BUFFER,new Float32Array([-1,-1,1,-1,-1,1,1,1]),t.STATIC_DRAW),s=t.getAttribLocation(c,"p"),t.enableVertexAttribArray(s),t.vertexAttribPointer(s,2,t.FLOAT,!1,0,0),t.viewport(0,0,64,64),t.drawArrays(t.TRIANGLE_STRIP,0,4),s=new Uint8Array(16384),t.readPixels(0,0,64,64,t.RGBA,t.UNSIGNED_BYTE,s),a.push(await d.hashBytes(s)),t.deleteBuffer(o),t.deleteProgram(c),t.deleteShader(n),t.deleteShader(i))}return e=(new TextEncoder).encode(a.join("|")),d.hashBytes(e)})(),new Promise(e=>setTimeout(()=>e("timeout_1000ms"),1e3))])}catch(e){return"error:"+e.message}}async getWebGL2CapsSHA(){try{let t=document.createElement("canvas").getContext("webgl2");if(!t)return"unavailable";let r={};["MAX_3D_TEXTURE_SIZE","MAX_ARRAY_TEXTURE_LAYERS","MAX_DRAW_BUFFERS","MAX_COLOR_ATTACHMENTS","MAX_SAMPLES","MAX_VERTEX_UNIFORM_BLOCKS","MAX_FRAGMENT_UNIFORM_BLOCKS","MAX_UNIFORM_BUFFER_BINDINGS"].forEach(e=>{try{r[e]=t.getParameter(t[e])}catch{r[e]="error"}});var e=(t.getSupportedExtensions()||[]).slice().sort();return await this.hashString(this.stableStringify({params:r,exts:e}))}catch(e){return"error:"+e.message}}async getWebGPUCapsSHA(){try{if(!("gpu"in navigator))return"unavailable";let t=await Promise.race([navigator.gpu.requestAdapter(),new Promise(e=>setTimeout(()=>e(null),1e3))]);if(!t)return"unavailable";var e=[...t.features].sort();let r={};return["maxBindGroups","maxTextureDimension2D","maxUniformBuffersPerShaderStage","maxSamplersPerShaderStage"].forEach(e=>{t.limits&&e in t.limits&&(r[e]=t.limits[e])}),await this.hashString(this.stableStringify({features:e,limits:r}))}catch(e){return"error:"+e.message}}async getFontsExtended(){try{var t=["Arial","Arial Black","Calibri","Cambria","Comic Sans MS","Consolas","Courier New","Georgia","Helvetica","Impact","Lucida Console","Monaco","Palatino","Tahoma","Times New Roman","Trebuchet MS","Verdana","Noto Sans","Noto Serif","Noto Sans Mono","DejaVu Sans","DejaVu Serif","DejaVu Sans Mono","Source Sans Pro","Source Serif Pro","Source Code Pro","Roboto","Roboto Slab","Roboto Mono","Open Sans","Inter","Fira Sans","Fira Mono","PT Sans","PT Serif","JetBrains Mono","SF Pro Display"];let e=["monospace","sans-serif","serif"],a="mmmmmmmmmmlli",o=document.createElement("canvas").getContext("2d"),s={},n=(e.forEach(e=>{o.font="72px "+e,s[e]=o.measureText(a).width}),[]);return t.forEach(t=>{let r=!1;e.forEach(e=>{o.font=`72px "${t}", `+e,o.measureText(a).width!==s[e]&&(r=!0)}),r&&n.push(t)}),n.sort(),{list:n,sha:await this.hashString(n.join("|"))}}catch{return{list:[],sha:"unavailable"}}}getStableMath(){return[()=>Math.sin(Math.PI/2),()=>Math.cos(0),()=>Math.tan(Math.PI/4),()=>Math.sqrt(2),()=>Math.E,()=>Math.LN2,()=>1,()=>Math.log(Math.exp(1)),()=>4*Math.atan2(1,1)].map(e=>Math.round(1e12*e())/1e12).join("|")}getEngine(){var e=Function.prototype.toString.toString(),t=["Array.from","Object.assign","Promise.resolve","Symbol.iterator","fetch","AbortController","BigInt","globalThis"].map(e=>{try{let t=window;return e.split(".").forEach(e=>t=t[e]),"function"==typeof t||"object"==typeof t?"1":"0"}catch{return"0"}}).join("");return{fnSigLen:e.length,methods:t}}getCSS(){let t=document.createElement("div");return["display:flex","display:grid","position:sticky","backdrop-filter:blur(1px)","clip-path:circle(50%)","writing-mode:vertical-lr","scroll-behavior:smooth","overscroll-behavior:contain"].map(e=>(t.style.cssText=e,0<t.style.length?"1":"0")).join("")}async getCrypto(){var e={};if(crypto&&crypto.subtle){var t,r=(new TextEncoder).encode("x"),a=[];for(t of["SHA-1","SHA-256","SHA-384","SHA-512"])try{await crypto.subtle.digest(t,r),a.push(t)}catch{}e.hashes=a.join("|");var o,s=[];for(o of[{name:"AES-GCM",length:256},{name:"AES-CBC",length:256},{name:"HMAC",hash:"SHA-256"}])try{o.name.startsWith("AES")?await crypto.subtle.generateKey(o,!1,["encrypt","decrypt"]):await crypto.subtle.generateKey(o,!1,["sign","verify"]),s.push(o.name)}catch{}e.keys=s.join("|")}else e.subtle=!1;return e}async getCryptoCapsExtendedSHA(){try{if(!crypto||!crypto.subtle)return"unavailable";var e={hkdf:!1,pbkdf2:!1,ecdh_p256:!1,import_formats:[],export_formats:[]},t=new TextEncoder;try{var r=await crypto.subtle.importKey("raw",t.encode("base"),{name:"HKDF"},!1,["deriveKey"]);await crypto.subtle.deriveKey({name:"HKDF",hash:"SHA-256",salt:t.encode("s"),info:t.encode("i")},r,{name:"AES-GCM",length:128},!1,["encrypt","decrypt"])&&(e.hkdf=!0)}catch{}try{var a=await crypto.subtle.importKey("raw",t.encode("password"),{name:"PBKDF2"},!1,["deriveKey"]);await crypto.subtle.deriveKey({name:"PBKDF2",hash:"SHA-256",salt:t.encode("salt"),iterations:1e3},a,{name:"AES-GCM",length:128},!1,["encrypt","decrypt"])&&(e.pbkdf2=!0)}catch{}try{var o=await crypto.subtle.generateKey({name:"ECDH",namedCurve:"P-256"},!0,["deriveBits"]),s=await crypto.subtle.generateKey({name:"ECDH",namedCurve:"P-256"},!0,["deriveBits"]);await crypto.subtle.deriveBits({name:"ECDH",public:s.publicKey},o.privateKey,128)&&(e.ecdh_p256=!0);try{await crypto.subtle.exportKey("spki",o.publicKey)&&e.export_formats.push("spki")}catch{}try{await crypto.subtle.exportKey("pkcs8",o.privateKey)&&e.export_formats.push("pkcs8")}catch{}try{await crypto.subtle.importKey("spki",await crypto.subtle.exportKey("spki",o.publicKey),{name:"ECDH",namedCurve:"P-256"},!0,[])&&e.import_formats.push("spki")}catch{}try{await crypto.subtle.importKey("pkcs8",await crypto.subtle.exportKey("pkcs8",o.privateKey),{name:"ECDH",namedCurve:"P-256"},!0,["deriveBits"])&&e.import_formats.push("pkcs8")}catch{}}catch{}return await this.hashString(this.stableStringify(e))}catch(e){return"error:"+e.message}}addCodecsSupport(){try{let a=document.createElement("video");var e={codec_h264:'video/mp4; codecs="avc1.42E01E"',codec_vp8:'video/webm; codecs="vp8"',codec_vp9:'video/webm; codecs="vp09.00.10.08"',codec_av1:'video/mp4; codecs="av01.0.00M.08"',codec_aac:'audio/mp4; codecs="mp4a.40.2"',codec_opus:'audio/webm; codecs="opus"',codec_vorbis:'audio/ogg; codecs="vorbis"'};let o=[];Object.entries(e).forEach(([e,t])=>{var r=a.canPlayType(t),r="probably"===r||"maybe"===r;this.addParam(e,r,"media","success","medium"),r&&o.push(t)}),this.addParam("video_codecs",o.join(","),"media","success","medium")}catch(e){this.addParam("video_codecs_error",e.message,"media","error","medium")}}async addMediaCapabilities(){try{if("mediaCapabilities"in navigator){var e,t=[];for(e of[{type:"file",video:{contentType:'video/mp4; codecs="avc1.42E01E"',width:1920,height:1080,bitrate:4e6,framerate:30}},{type:"file",video:{contentType:'video/webm; codecs="vp8"',width:1920,height:1080,bitrate:4e6,framerate:30}},{type:"file",video:{contentType:'video/webm; codecs="vp09.00.10.08"',width:1920,height:1080,bitrate:4e6,framerate:30}},{type:"file",video:{contentType:'video/mp4; codecs="av01.0.05M.08"',width:1920,height:1080,bitrate:4e6,framerate:30}},{type:"file",audio:{contentType:'audio/mp4; codecs="mp4a.40.2"',channels:2,bitrate:128e3,samplerate:44100}},{type:"file",audio:{contentType:'audio/webm; codecs="opus"',channels:2,bitrate:128e3,samplerate:48e3}},{type:"file",audio:{contentType:'audio/ogg; codecs="vorbis"',channels:2,bitrate:128e3,samplerate:44100}}]){var r=await navigator.mediaCapabilities.decodingInfo(e);t.push({k:(e.video||e.audio).contentType,s:!!r.supported,pe:!!r.powerEfficient,sm:!!r.smooth})}t.sort((e,t)=>e.k<t.k?-1:1),this.addParam("media_capabilities_profile",JSON.stringify(t),"media","success","medium")}else this.addParam("media_capabilities","unavailable","media","error","low")}catch(e){this.addParam("media_capabilities_error",e.message,"media","error","low")}}addBrowserSystem(){var e=window.devicePixelRatio||1,t=Math.round(screen.width*e),r=Math.round(screen.height*e);this.addParam("screen_physical_resolution",t+"x"+r,"display","success","high"),this.addParam("device_pixel_ratio",e,"display","success","high"),this.addParam("screen_color_depth",screen.colorDepth,"display","success","high"),this.addParam("screen_pixel_depth",screen.pixelDepth||"unavailable","display","success","medium"),this.addParam("platform",navigator.platform,"system","success","high"),this.addParam("languages",(navigator.languages||[]).join(","),"system","success","medium"),this.addParam("timezone",Intl.DateTimeFormat().resolvedOptions().timeZone,"system","success","high"),this.addParam("timezone_offset",(new Date).getTimezoneOffset(),"system","success","high"),this.addParam("intl_calendar",this.safeGet(()=>Intl.DateTimeFormat().resolvedOptions().calendar),"system","success","low"),this.addParam("intl_numbering_system",this.safeGet(()=>Intl.DateTimeFormat().resolvedOptions().numberingSystem),"system","success","low"),this.addParam("hardware_concurrency",navigator.hardwareConcurrency||"unavailable","hardware","success","high"),"deviceMemory"in navigator&&this.addParam("device_memory",navigator.deviceMemory,"hardware","success","medium"),this.addParam("max_touch_points",navigator.maxTouchPoints||0,"hardware","success","medium"),this.addParam("touch_support","ontouchstart"in window,"hardware","success","low"),this.addParam("app_name",navigator.appName||"unavailable","browser","success","low"),this.addParam("product",navigator.product||"unavailable","browser","success","low"),this.addParam("webdriver",!!navigator.webdriver,"browser","success","high"),this.addParam("pdf_viewer_enabled",navigator.pdfViewerEnabled||"unavailable","browser","success","low"),this.addParam("webassembly_support","undefined"!=typeof WebAssembly,"browser","success","low"),this.addParam("webrtc_support","undefined"!=typeof RTCPeerConnection,"browser","success","low"),this.addParam("websocket_support","undefined"!=typeof WebSocket,"browser","success","low"),this.addParam("service_worker_support","serviceWorker"in navigator,"browser","success","low"),this.addParam("notification","Notification"in window,"browser","success","low"),this.addParam("push_messaging","PushManager"in window,"browser","success","low"),this.addParam("geolocation","geolocation"in navigator,"browser","success","low"),this.addParam("speech_synthesis","speechSynthesis"in window,"browser","success","low"),this.addParam("local_storage","undefined"!=typeof localStorage,"browser","success","low"),this.addParam("session_storage","undefined"!=typeof sessionStorage,"browser","success","low"),this.addParam("indexed_db","undefined"!=typeof indexedDB,"browser","success","low"),this.addParam("storage_quota_api","storage"in navigator&&"estimate"in navigator.storage,"browser","success","low"),this.addParam("prefers_reduced_motion",window.matchMedia("(prefers-reduced-motion: reduce)").matches,"display","success","low"),this.addParam("prefers_color_scheme_dark",window.matchMedia("(prefers-color-scheme: dark)").matches,"display","success","low"),this.addParam("prefers_color_scheme_light",window.matchMedia("(prefers-color-scheme: light)").matches,"display","success","low"),this.addParam("forced_colors",window.matchMedia("(forced-colors: active)").matches,"display","success","low"),this.addParam("inverted_colors",window.matchMedia("(inverted-colors: inverted)").matches,"display","success","low"),this.addParam("prefers_contrast_high",window.matchMedia("(prefers-contrast: high)").matches,"display","success","low"),this.addParam("any_hover",window.matchMedia("(any-hover: hover)").matches,"display","success","low"),this.addParam("any_pointer_coarse",window.matchMedia("(any-pointer: coarse)").matches,"display","success","low"),this.addParam("any_pointer_fine",window.matchMedia("(any-pointer: fine)").matches,"display","success","low")}getSelectedMap(){let r={},a=(Object.keys(this.allParams).forEach(e=>{var t=document.getElementById("cb-"+e);t&&t.checked&&(r[e]=this.allParams[e])}),!1);return Object.keys(this.allParams).forEach(e=>{var t=document.getElementById("cb-"+e);t&&(a=!0),t&&t.checked&&(r[e]=this.allParams[e])}),a||Object.keys(this.allParams).forEach(e=>{"success"===this.paramStatus[e]&&(r[e]=this.allParams[e])}),r}async buildModuleHashes(r){let a={};Object.keys(r).forEach(e=>{var t=this.paramCategory[e]||"other";(a[t]||(a[t]={}))[e]=r[e]});var e,t={};for(e of Object.keys(a).sort())t[e]=await this.hashString(this.stableStringify(a[e]));return t}async updateHash(){var e,t=this.getSelectedMap(),r={};for(e of Object.keys(t).sort())r[e]=t[e];var a,o=await this.buildModuleHashes(r),s={};for(a of Object.keys(o).sort())s[a]=o[a];return await this.hashString(this.stableStringify(s))}async collectFingerprint(){try{var e=window.devicePixelRatio||1,t=Math.round(screen.width*e),r=Math.round(screen.height*e),a=(this.addParam("screen_physical_resolution",t+"x"+r,"display","success","high"),this.addParam("device_pixel_ratio",e,"display","success","high"),this.addParam("screen_color_depth",screen.colorDepth,"display","success","high"),this.addParam("screen_pixel_depth",screen.pixelDepth||"unavailable","display","success","medium"),this.addParam("platform",navigator.platform,"system","success","high"),this.addParam("languages",(navigator.languages||[]).join(","),"system","success","medium"),this.addParam("timezone",Intl.DateTimeFormat().resolvedOptions().timeZone,"system","success","high"),this.addParam("timezone_offset",(new Date).getTimezoneOffset(),"system","success","high"),this.addParam("intl_calendar",this.safeGet(()=>Intl.DateTimeFormat().resolvedOptions().calendar),"system","success","low"),this.addParam("intl_numbering_system",this.safeGet(()=>Intl.DateTimeFormat().resolvedOptions().numberingSystem),"system","success","low"),this.addParam("hardware_concurrency",navigator.hardwareConcurrency||"unavailable","hardware","success","high"),"deviceMemory"in navigator&&this.addParam("device_memory",navigator.deviceMemory,"hardware","success","medium"),this.addParam("max_touch_points",navigator.maxTouchPoints||0,"hardware","success","medium"),this.addParam("touch_support","ontouchstart"in window,"hardware","success","low"),this.addParam("canvas_fingerprint",await this.getStableCanvasHash(),"canvas","success","high"),this.getWebGLParams()),o=(Object.entries(a).forEach(([e,t])=>{var r=["UNMASKED_VENDOR","UNMASKED_RENDERER","MAX_TEXTURE_SIZE","WEBGL_EXTENSIONS_SORTED"].includes(e)?"high":"medium";this.addParam(e,t,"webgl","error"===t?"error":"success",r)}),this.addParam("gl_render_sha",await this.getGLRenderSHA(),"webgl","success","high"),this.addParam("webgl2_caps_sha",await this.getWebGL2CapsSHA(),"webgl","success","high"),this.addParam("webgpu_caps_sha",await this.getWebGPUCapsSHA(),"webgpu","success","high"),this.addParam("enhanced_math_precision",this.getStableMath(),"enhanced_math","success","high"),this.getEngine()),s=(this.addParam("enhanced_js_fnSigLen",o.fnSigLen,"enhanced_engine","success","high"),this.addParam("enhanced_method_support",o.methods,"enhanced_engine","success","high"),this.addParam("enhanced_css_support",this.getCSS(),"enhanced_css","success","medium"),await this.getCrypto()),n=(this.addParam("enhanced_crypto_hash_algorithms",s.hashes||"","enhanced_crypto","success","medium"),this.addParam("enhanced_crypto_key_algorithms",s.keys||"","enhanced_crypto","success","medium"),this.addParam("crypto_caps_sha",await this.getCryptoCapsExtendedSHA(),"enhanced_crypto","success","high"),this.addParam("js_heap_size_limit",this.safeGet(()=>performance&&performance.memory&&performance.memory.jsHeapSizeLimit),"system","success","high"),!(!window.WebAssembly||"object"!=typeof WebAssembly)),i=!(!window.WebAssembly||"undefined"==typeof SharedArrayBuffer||!0!==self.crossOriginIsolated);this.addParam("wasm_simd_support",n,"runtime","success","high"),this.addParam("wasm_threads_support",i,"runtime","success","high");try{var c,d=window.AudioContext||window.webkitAudioContext;d?(c=new d,this.addParam("audio_base_latency",c.baseLatency||"na","media","success","medium"),c&&"function"==typeof c.close&&await c.close()):this.addParam("audio_base_latency","unavailable","media","error","medium")}catch(e){this.addParam("audio_base_latency","error","media","error","medium")}try{var l=document.createElement("canvas").getContext("webgl")||document.createElement("canvas").getContext("experimental-webgl");if(l){var _=(l.getSupportedExtensions()||[]).slice().sort(),h=(this.addParam("webgl_extensions_sorted",_.join(","),"webgl","success","high"),{s3tc:!!l.getExtension("WEBGL_compressed_texture_s3tc")||!!l.getExtension("MOZ_WEBGL_compressed_texture_s3tc")||!!l.getExtension("WEBKIT_WEBGL_compressed_texture_s3tc"),s3tc_srgb:!!l.getExtension("WEBGL_compressed_texture_s3tc_srgb"),etc1:!!l.getExtension("WEBGL_compressed_texture_etc1"),etc:!!l.getExtension("WEBGL_compressed_texture_etc"),pvrtc:!!l.getExtension("WEBGL_compressed_texture_pvrtc")||!!l.getExtension("WEBKIT_WEBGL_compressed_texture_pvrtc"),astc:!!l.getExtension("WEBGL_compressed_texture_astc"),rgtc:!!l.getExtension("EXT_texture_compression_rgtc"),bptc:!!l.getExtension("EXT_texture_compression_bptc")});this.addParam("webgl_supported_compressions",JSON.stringify(h),"webgl","success","high");try{var m=l.getExtension("WEBGL_debug_renderer_info"),u=m?l.getParameter(m.UNMASKED_RENDERER_WEBGL):"unavailable";this.addParam("webgl_unmasked_renderer",u||"unavailable","webgl","success","high")}catch{this.addParam("webgl_unmasked_renderer","error","webgl","error","high")}}else this.addParam("webgl_extensions_sorted","unavailable","webgl","error","high"),this.addParam("webgl_supported_compressions","unavailable","webgl","error","high"),this.addParam("webgl_unmasked_renderer","unavailable","webgl","error","high")}catch{this.addParam("webgl_extensions_sorted","error","webgl","error","high"),this.addParam("webgl_supported_compressions","error","webgl","error","high"),this.addParam("webgl_unmasked_renderer","error","webgl","error","high")}this.addCodecsSupport(),await this.addMediaCapabilities(),this.addBrowserSystem(),this.recommended=["screen_physical_resolution","device_pixel_ratio","screen_color_depth","platform","hardware_concurrency","max_touch_points","timezone","canvas_fingerprint","UNMASKED_VENDOR","UNMASKED_RENDERER","MAX_TEXTURE_SIZE","WEBGL_EXTENSIONS_SORTED","webgl_supported_compressions","webgl_extensions_sorted","webgl_unmasked_renderer","enhanced_math_precision","enhanced_js_fnSigLen","enhanced_method_support","enhanced_css_support","enhanced_crypto_hash_algorithms","crypto_caps_sha","js_heap_size_limit","wasm_simd_support","wasm_threads_support","audio_base_latency","gl_render_sha","webgl2_caps_sha","webgpu_caps_sha"]}catch(e){console.error(e),this.addParam("main_error",String(e&&e.message?e.message:e),"system","error","high")}finally{return this.updateHash()}}}class d{static maxLifetime=600;static get(e,t){void 0===t&&(t="value");e=localStorage.getItem(e);if(null!==e)try{var r=JSON.parse(e);return r.hasOwnProperty(t)?r[t]:r}catch(e){return new Error(e)}return!1}static set(e,t){t={value:t,timestamp:Math.floor((new Date).getTime()/1e3)};localStorage.setItem(e,JSON.stringify(t))}static isAlive(e,t){return void 0===t&&(t=this.maxLifetime),this.get(e,"timestamp")+t>Math.floor((new Date).getTime()/1e3)}static isSet(e){return null!==localStorage.getItem(e)}static delete(e){localStorage.removeItem(e)}}class e{constructor(){this.logLsName="ct_bot_detector_frontend_data_log",this.logsLimit=10,this.getInstance(),this.enabled=!1}writeLog(e){e.frontend_data=this.filterFrontendData(e.frontend_data),e.responder_data=this.filterResponderData(e.responder_data),e.forms_processed=this.filterFormsProcessed(e.forms_processed),this.instance.records.push(e),this.instance.log_last_update=Math.floor((new Date).getTime()/1e3),this.saveInstance()}getInstance(){this.dropInstance(),this.instance={log_start:Math.floor((new Date).getTime()/1e3),log_last_update:"",records:[]}}validateInstance(e){return"object"==typeof e&&!(!(e.hasOwnProperty("log_start")&&e.hasOwnProperty("log_last_update")&&e.hasOwnProperty("records"))||e.records.length>this.logsLimit)&&Array.isArray(e.records)}dropInstance(){d.delete(this.logLsName)}saveInstance(){this.validateInstance(this.instance)&&d.set(this.logLsName,JSON.stringify(this.instance))}getRecordInstance(){return{success:!1,timestamp_on_send:null,timestamp_on_received:null,frontend_data:{event_token:"",js_event:""},responder_data:{host_name:"",headers:"",new_event_token:""},forms_processed:{forms_count:0,forms_list:[],forms_handling_error:""},error:""}}filterFrontendData(e){return e={event_token:e.hasOwnProperty("event_token")?e.event_token:"",js_event:e.hasOwnProperty("js_event")?e.js_event:""}}filterResponderData(e){return e={host_name:e.hasOwnProperty("host_name")?e.host_name:"",headers:e.hasOwnProperty("headers")?e.headers:"",new_event_token:e.hasOwnProperty("new_event_token")?e.new_event_token:""}}filterFormsProcessed(e){return e={forms_count:e.hasOwnProperty("forms_count")?e.forms_count:0,forms_list:e.hasOwnProperty("forms_list")?e.forms_list:[],forms_handling_error:e.hasOwnProperty("forms_handling_error")?e.forms_handling_error:""}}}class f{static keysObj={key_esc_pressed:!1,key_backspace_pressed:!1,key_capslock_pressed:!1,key_shift_ctrl_pressed:!1,key_shift_alt_pressed:!1,key_mobile_capslock_pressed:!1};collectSpecialKeys(e){let t=!1;"Escape"===e.key&&(f.keysObj.key_esc_pressed=!0,t=!0),"Backspace"===e.key&&(f.keysObj.key_backspace_pressed=!0,t=!0),"CapsLock"===e.key&&(f.keysObj.key_capslock_pressed=!0,t=!0),"Shift"===e.key&&e.ctrlKey&&(f.keysObj.key_shift_ctrl_pressed=!0,t=!0),"Shift"===e.key&&e.altKey&&(f.keysObj.key_shift_alt_pressed=!0,t=!0);var r=/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent);return"input"===e.type&&r&&e.target&&e.target.value&&(r=e.target.value.slice(-1))&&r===r.toUpperCase()&&r!==r.toLowerCase()&&r.match(/[A-Z\u0400-\u042F\u0401]/u)&&(f.keysObj.key_mobile_capslock_pressed=!0,t=!0),t}}class g{fieldData={fieldName:"",fieldType:"",isAutocompleteExist:!1,isAutocomplete:!1,label:"",isUseBuffer:!1,speedDelta:0,firstKeyTimestamp:0,lastKeyTimestamp:0,lastDelta:0,countOfKey:0};fields=document.querySelectorAll("input[type=text], input[type=email], textarea");data=[];gatheringFields(){Array.prototype.slice.call(this.fields).forEach((e,t)=>{var r=Object.assign({},this.fieldData);e.name&&(r.fieldName=e.name),e.nodeName&&(r.fieldType=e.nodeName),e.autocomplete&&"off"!==e.autocomplete&&(r.isAutocompleteExist=!0,r.isAutocomplete=e.autocomplete),e.labels&&0<e.labels.length&&(r.label=e.labels[0].innerText),this.data.push(Object.assign({},r))})}setListeners(){this.fields.forEach((e,t)=>{e.addEventListener("paste",e=>{e&&"object"==typeof e&&e instanceof ClipboardEvent?e.clipboardData.getData("text"):void 0!==window.clipboardData&&window.clipboardData.getData("text"),this.data[t].isUseBuffer=!0})}),this.fields.forEach((e,a)=>{e.addEventListener("input",e=>{this.data[a].countOfKey++;var t,r=+new Date;1===this.data[a].countOfKey?(this.data[a].lastKeyTimestamp=r,this.data[a].firstKeyTimestamp=r):(t=r-this.data[a].lastKeyTimestamp,2===this.data[a].countOfKey?(this.data[a].lastKeyTimestamp=r,this.data[a].lastDelta=t):2<this.data[a].countOfKey&&(this.data[a].speedDelta+=Math.abs(this.data[a].lastDelta-t),this.data[a].lastKeyTimestamp=r,this.data[a].lastDelta=t))})})}}function isFromExcludedFromEventTokenField(e,t){if(void 0!==e.attributes.method&&"get"===e.method)return!0;let r=!1;try{var a=getAllDescendantNodes(e),o={selfAttributes:void 0!==e.attributes&&e.attributes,children:void 0!==a&&a!==[]&&a,parent:void 0!==e.parentNode&&e.parentNode.attributes};if(void 0!==t)for(var s in t){var n=t[s];if("object"==typeof n&&n.hasOwnProperty("signs_to_check")){var i=!(!n.signs_to_check.hasOwnProperty("form_attributes")||""===n.signs_to_check.form_attributes)&&n.signs_to_check.form_attributes,c=!(!n.signs_to_check.hasOwnProperty("form_parent_attributes")||""===n.signs_to_check.form_parent_attributes)&&n.signs_to_check.form_parent_attributes,d=!(!n.signs_to_check.hasOwnProperty("form_children_attributes")||""===n.signs_to_check.form_children_attributes)&&n.signs_to_check.form_children_attributes;if(i&&o.selfAttributes)r=checkAttributesExclusions(o.selfAttributes,i);else if(c&&o.parent)r=checkAttributesExclusions(o.parent,c);else if(d&&o.children)for(var l in o.children){if(r)break;void 0===o.children[l]||isChildExcludedCtServiceField(o.children[l])||(r=checkAttributesExclusions(o.children[l].attributes,d))}if(r)return n}}}catch(e){console.warn("CleanTalk Bot Detector exclusion check error: "+e.message)}return r}function getPregMatchBool(e,t){if("string"==typeof e&&"string"==typeof t){if(""===e||""===t)return!1;if(e.match(t))return!0}return!1}function checkAttributesExclusions(e,t){let r=!1;for(var a in e){if(r)break;"object"==typeof e[a]&&null!==e[a]&&"string"==typeof e[a].nodeValue&&(r=getPregMatchBool(e[a].nodeValue,t))}return r}function getAllDescendantNodes(e,t=[]){t.push(...e.childNodes);for(var r of e.childNodes)getAllDescendantNodes(r,t);return t}function isChildExcludedCtServiceField(e){return"string"==typeof e.id&&(-1!==e.id.indexOf("apbct__email_id")||-1!==e.id.indexOf("apbct_event_id")||-1!==e.id.indexOf("apbct_visible_fields")||-1!==e.id.indexOf("ct_checkjs"))||"string"==typeof e.name&&-1!==e.name.indexOf("ct_no_cookie_hidden_field")}function botDetectorOnAnimationStart(e){("onautofillstart"===e.animationName?botDetectorAutocomplete:botDetectorCancelAutocomplete)(e.target)}function botDetectorOnInput(e){("insertReplacementText"!==e.inputType&&"data"in e?botDetectorCancelAutocomplete:botDetectorAutocomplete)(e.target)}function botDetectorAutocomplete(e){var t;e.hasAttribute("autocompleted")||(e.setAttribute("autocompleted",""),t=new window.CustomEvent("onautocomplete",{bubbles:!0,cancelable:!0,detail:null}),e.dispatchEvent(t))||(e.value="")}function botDetectorCancelAutocomplete(e){e.hasAttribute("autocompleted")&&(e.removeAttribute("autocompleted"),e.dispatchEvent(new window.CustomEvent("onautocomplete",{bubbles:!0,cancelable:!1,detail:null})))}let t="1.1.54",r=(new Date).getTime(),o=[],s=!0,n=0,i=[],l=5e3,_,h={send_on_cron:!0,send_on_stop_collect:!1,last_data_length:0},m={last_data_length:0},u=new e,p=new b;function botDetectorInit(){botDetectorGetFingerprint().then(e=>{d.set("bot_detector_f_hash",e)});[["bot_detector_pointer_data",0],["bot_detector_screen_info",botDetectorGetScreenInfo()],["bot_detector_headless",navigator.webdriver],["bot_detector_list_keys_pressed",f.keysObj]].forEach(e=>{d.set(e[0],e[1])});var e=d.get("bot_detector_page_hits")?d.get("bot_detector_page_hits"):0,e=(d.set("bot_detector_page_hits",parseInt(e)+1),d.get("bot_detector_user_agent")?d.get("bot_detector_user_agent"):window.navigator.userAgent);d.set("bot_detector_user_agent",e),_=botDetectorGetFormsExclusions(),botDetectorStartFormsListeners(),botDetectorSetBrowserCookieSupportFlag(),botDetectorSetWebGlSupportFlag(),botDetectorSetReferrers(),p.runService(),botDetectorFrontendData("DOMContentLoaded"),setInterval(()=>{d.isSet("bot_detector_event_token")&&!d.isAlive("bot_detector_event_token")&&botDetectorFrontendData("automaticRefresh")},3e3);document.typoData=new g,document.typoData.gatheringFields(),document.typoData.setListeners(),document.botDetectorSpecialKeys=new f}function botDetectorGetFormsExclusions(){let e=[];try{e=(e="object"==typeof ctPublic&&!0===ctPublic.hasOwnProperty("bot_detector_forms_excluded"))?JSON.parse(atob(ctPublic.bot_detector_forms_excluded)):[]}catch{}return e}function botDetectorStartFormsListeners(){var t=document.forms;if(0<t.length)for(let e=0;e<t.length;e++)t[e].addEventListener("submit",()=>{botDetectorFrontendData("submit")});botDetectorStartFieldsListening(t)}function botDetectorAttachEventHandler(e,t,r){"function"==typeof window.addEventListener?e.addEventListener(t,r):e.attachEvent(t,r)}function botDetectorRemoveEventHandler(e,t,r){"function"==typeof window.removeEventListener?e.removeEventListener(t,r):e.detachEvent(t,r)}function botDetectorGetScreenInfo(){return{fullWidth:document.documentElement.scrollWidth,fullHeight:Math.max(document.body.scrollHeight,document.documentElement.scrollHeight,document.body.offsetHeight,document.documentElement.offsetHeight,document.body.clientHeight,document.documentElement.clientHeight),visibleWidth:document.documentElement.clientWidth,visibleHeight:document.documentElement.clientHeight}}function botDetectorMouseStopData(){h.send_on_stop_collect=!0,window.removeEventListener("mousemove",botDetectorGetMouseData)}function botDetectorGetMouseData(e){s&&(o.push([Math.round(e.clientY),Math.round(e.clientX),Math.round((new Date).getTime()-r)]),s=!1,new Promise(e=>{setTimeout(()=>e(),150)}).then(()=>{d.set("bot_detector_pointer_data",o),n++,s=!0}),150<=n)&&botDetectorMouseStopData()}function botDetectorSetHasScrolled(){d.isSet("bot_detector_has_scrolled")&&d.isAlive("bot_detector_has_scrolled")&&d.get("bot_detector_has_scrolled")||(d.set("bot_detector_has_scrolled",!0),botDetectorFrontendData("scrolled"))}let y=150,v=window.scrollY||document.documentElement.scrollTop,w=(new Date).getTime(),E=w,S=0,D=0,P=[],k=["timestamp","scrollTop","scrollSpeed","scrollDistance","scrollPercent","scrollEndCount","scrollDelay","scrollCount"];function botDetectorCollectScrollingParameters(){var e=window.scrollY||document.documentElement.scrollTop,t=(new Date).getTime(),r=document.documentElement.scrollHeight||document.body.scrollHeight,a=window.innerHeight||document.documentElement.clientHeight,o=e/(r-a)*100,s=Math.abs(e-v),n=s/((t-w)/1e3),i=(t-E)/1e3;v=e,w=t,E=t,r<=e+a&&S++,D++,P.push([t,e,n,s,o,S,i,D]),P.length>y&&(P=P.slice(P.length-y)),d.set("bot_detector_scrolling_additional",P)}function botDetectorSendScrollingParameters(e){var t,r=d.isSet("bot_detector_scrolling_additional")?d.get("bot_detector_scrolling_additional","value"):0;if(0!==r&&void 0!==r.length&&m.last_data_length!==r.length)return(t=botDetectorCreateClientInfo()).scrolling_additional=r,botDetectorSendClientInfoToCloud(t,e),m.last_data_length=r.length,!0;return!1}function botDetectorSetMouseMoved(){d.isSet("bot_detector_mouse_moved")&&d.isAlive("bot_detector_mouse_moved")&&d.get("bot_detector_mouse_moved")||(d.set("bot_detector_mouse_moved",!0),botDetectorFrontendData("mousemoved"))}function botDetectorStartFieldsListening(t){if((!d.isSet("bot_detector_has_key_up")&&!d.get("bot_detector_has_key_up")||!d.isSet("bot_detector_has_input_focused")&&!d.get("bot_detector_has_input_focused"))&&0<t.length)for(let e=0;e<t.length;e++){var r=t[e].querySelectorAll("input,textarea");for(let e=0;e<r.length;e++)"hidden"!==r[e].type&&(i.push(r[e]),botDetectorAttachEventHandler(r[e],"focus",T),botDetectorAttachEventHandler(r[e],"keyup",A))}}function botDetectorStopFieldsListening(t,r){if(void 0!==i&&0<i.length)for(let e=0;e<i.length;e++)botDetectorRemoveEventHandler(i[e],t,r)}P.push(k);let T=function(){d.isSet("bot_detector_has_input_focused")&&d.get("bot_detector_has_input_focused")||d.set("bot_detector_has_input_focused",!0),botDetectorStopFieldsListening("focus",T)},A=function(){d.isSet("bot_detector_has_key_up")&&d.get("bot_detector_has_key_up")||d.set("bot_detector_has_key_up",!0),botDetectorStopFieldsListening("keyup",A)};function botDetectorSetReferrers(){d.set("bot_detector_referrer",window.location.href),d.set("bot_detector_referrer_previous",document.referrer)}function botDetectorSetBrowserCookieSupportFlag(){if(!d.isSet("bot_detector_browser_supports_cookies")||!d.isAlive("bot_detector_browser_supports_cookies")||!d.get("bot_detector_browser_supports_cookies")){let t=navigator.cookieEnabled;if(!t)try{document.cookie="testcookie="+encodeURIComponent("testcookievalue")+"; path=/",t=-1!==document.cookie.indexOf("testcookie")}catch(e){t=!1}d.set("bot_detector_browser_supports_cookies",t)}}function botDetectorSetWebGlSupportFlag(){var e=document.createElement("canvas");e.getContext("webgl")||e.getContext("experimental-webgl")?d.set("bot_detector_webgl_support",!0):d.set("bot_detector_webgl_support",!1)}function botDetectorCreateClientInfo(){return{agent:"bot_detector_"+t,timestamp:Math.floor((new Date).getTime()/1e3)}}function botDetectorFrontendData(e){var t=botDetectorCreateClientInfo();d.isSet("bot_detector_list_keys_pressed")&&(t.bot_detector_list_keys_pressed=d.get("bot_detector_list_keys_pressed")),d.isSet("bot_detector_headless")&&(t.headless=d.get("bot_detector_headless")),d.isSet("bot_detector_page_hits")&&(t.page_hits=d.get("bot_detector_page_hits")),d.isSet("bot_detector_has_scrolled")&&(t.has_scrolled=d.get("bot_detector_has_scrolled")),d.isSet("bot_detector_mouse_moved")&&(t.mouse_moved=d.get("bot_detector_mouse_moved")),d.isSet("bot_detector_pointer_data")&&(t.pointer_data=d.get("bot_detector_pointer_data")),d.isSet("bot_detector_screen_info")&&(t.screen_info=d.get("bot_detector_screen_info")),d.isSet("bot_detector_user_agent")&&(t.user_agent=d.get("bot_detector_user_agent")),d.isSet("bot_detector_referrer")&&(t.REFFERRER=d.get("bot_detector_referrer")),d.isSet("bot_detector_referrer_previous")&&(t.REFFERRER_PREVIOUS=d.get("bot_detector_referrer_previous")),d.isSet("bot_detector_browser_supports_cookies")&&(t.cookies_enabled=d.get("bot_detector_browser_supports_cookies")),d.isSet("bot_detector_has_input_focused")&&(t.has_input_focused=d.get("bot_detector_has_input_focused")),d.isSet("bot_detector_has_key_up")&&(t.has_key_up=d.get("bot_detector_has_key_up")),d.isSet("bot_detector_webgl_support")&&(t.webgl=d.get("bot_detector_webgl_support")),d.isSet("bot_detector_scrolling_additional")&&(t.scrolling_additional=d.get("bot_detector_scrolling_additional")),"submit"===e&&document.typoData&&(t.typo=document.typoData.data),botDetectorSendClientInfoToCloud(t,e)}function botDetectorSendClientInfoToCloud(e,t){t={event_token:d.isSet("bot_detector_event_token")&&d.isAlive("bot_detector_event_token")?d.get("bot_detector_event_token"):null,js_event:t,page_url:window.location.href,data:e};let o=u.getRecordInstance();o.frontend_data=t,o.timestamp_on_send=Math.floor((new Date).getTime()/1e3),1<Object.keys(e).length&&a.send("frontend_data",t).then(e=>{o.responder_data.headers=e.getAllResponseHeaders(),o.timestamp_on_received=Math.floor((new Date).getTime()/1e3);try{var t,r,a=JSON.parse(e.response);"SUCCESS"===a.data.operation_status?(d.set("bot_detector_event_token",a.event_token),o.forms_processed=setEventTokenFieldsToForms(a.event_token),o.responder_data.new_event_token=a.event_token,o.success=!0,t=new CustomEvent("botDetectorEventTokenUpdated",{detail:{eventToken:a.event_token,timestamp:Date.now()}}),window.dispatchEvent(t)):(r="API error: "+a.error_no+" - "+a.error_message,console.log(r),o.error=r),o.responder_data.host_name=a.hasOwnProperty("host_name")?a.host_name:"not provided"}catch(e){o.error=e.toString(),console.log("Can not parse the response. "+e.toString())}}).catch(e=>{console.log(e.toString()),o.error=e.toString()}).finally(()=>{!0===u.enabled&&u.writeLog(o)})}function setEventTokenFieldsToForms(t){var e,r={forms_count:0,forms_list:[],forms_handling_error:""};if("string"!=typeof t||64!==t.length)e="API error: no valid bot detector event token found in server response.",console.warn(e),r.forms_handling_error=e;else{var a=document.forms;if(d.delete("ct_bot_detector_form_exclusion"),0<a.length)for(let e=0;e<a.length;e++){var o=isFromExcludedFromEventTokenField(a[e],_);if(!1!==o){let e;try{e=JSON.stringify(o)}catch{e=JSON.stringify("JSON error")}d.set("ct_bot_detector_form_exclusion",e)}else if(setEventTokenFormField(a[e],t,e)){r.forms_count++;var s=a[e].attributes,n={};for(let e=0;e<s.length;e++)s[e].name&&s[e].value&&(n[s[e].name]=s[e].value);r.forms_list.push(n)}}}return r}function setEventTokenFormField(e,t,r){if(void 0!==e.elements.ct_bot_detector_event_token)return e.elements.ct_bot_detector_event_token.value=t,!1;var a=document.createElement("input");a.setAttribute("type","hidden");let o=100+Math.floor(899*Math.random());return o=o.toString()+r.toString().substring(-1),a.setAttribute("id","ct_bot_detector_event_token_"+o),a.setAttribute("name","ct_bot_detector_event_token"),a.value=t,e.append(a),!0}async function botDetectorGetFingerprint(){var t=new c,r={f_hash:"",error_msg:"",success:!1,sent:!1};try{var e=await t.collectFingerprint();r.f_hash=e||"",r.success=!!e}catch(e){r.error_msg=e&&e.message?e.message:String(e),t&&"function"==typeof t.addParam&&t.addParam("main_error",r.error_msg,"error","high","system")}return r}function botDetectorCollectSpecialKeys(e){document.botDetectorSpecialKeys&&document.botDetectorSpecialKeys.collectSpecialKeys(e)&&d.set("bot_detector_list_keys_pressed",f.keysObj)}"loading"!==document.readyState?botDetectorInit():document.addEventListener("DOMContentLoaded",botDetectorInit),window.addEventListener("mousemove",botDetectorGetMouseData),window.addEventListener("mousemove",botDetectorSetMouseMoved),window.addEventListener("scroll",botDetectorSetHasScrolled),window.addEventListener("scroll",botDetectorCollectScrollingParameters),window.addEventListener("animationstart",botDetectorOnAnimationStart,!0),window.addEventListener("input",botDetectorOnInput,!0),window.addEventListener("keydown",botDetectorCollectSpecialKeys),window.addEventListener("input",botDetectorCollectSpecialKeys)}